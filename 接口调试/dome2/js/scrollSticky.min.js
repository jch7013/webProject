(function(){function c(){this.init.apply(this,arguments)}c.setting={stickyNode:null,fixedNode:null,top:0,zIndex:100,fixedClazz:"",runInScrollFn:null};var a=c.prototype;var b=window;a.init=function(d){this.setting=$.extend({},c.setting,d,true);if(d.fixedNode){this.fixedNode=d.fixedNode[0]||d.fixedNode;this.stickyNode=d.stickyNode[0]||d.stickyNode;this.cssStickySupport=this.checkStickySupport();this.stickyNodeHeight=this.stickyNode.clientHeight;this.fixedClazz=d.fixedClazz;this.top=parseInt(d.top,10)||0;this.zIndex=parseInt(d.zIndex)||1;this.setStickyCss();this.isfixed=false;this.onscrollCb=this.throttle(function(){this.nextFrame(this.sticky.bind(this))}.bind(this),50,100);this.initCss=this.getInitCss();this.fixedCss=this.getFixedCss();this.addEvent()}};a.getInitCss=function(){if(!!this.fixedNode){return"position:"+this.fixedNode.style.position+";top:"+this.fixedNode.style.top+"px;z-index:"+this.fixedNode.style.zIndex+";"}return""};a.getFixedCss=function(){return"position:fixed;top:"+this.top+"px;z-index:"+this.zIndex+";"};a.setFixedCss=function(d){if(!this.cssStickySupport){if(!!this.fixedNode){this.fixedNode.style.cssText=d}}};a.checkStickySupport=function(){var d=null;if(b.CSS&&b.CSS.supports){return b.CSS.supports("(position: sticky) or (position: -webkit-sticky)")}d=document.createElement("div");d.style.position="sticky";if("sticky"===d.style.position){return true}d.style.position="-webkit-sticky";if("-webkit-sticky"===d.style.position){return true}d=null;return false};a.setStickyCss=function(){if(this.cssStickySupport){this.stickyNode.style.cssText="position:-webkit-sticky;position:sticky;top:"+this.top+"px;z-index:"+this.zIndex+";"}};a.addEvent=function(){$(b).on("scroll",this.onscrollCb.bind(this))};a.throttle=function(e,d,g){var h=null;var f;return function(){var j=+new Date();var i=arguments;b.clearTimeout(h);if(!f){f=j}if(j-f>g){e.apply(this,i);f=j}else{b.setTimeout(function(){e.apply(this,i)}.bind(this),d)}}.bind(this)};a.nextFrame=(function(e){var g=["ms","moz","webkit","o"];var f={};f.requestAnimationFrame=window.requestAnimationFrame;for(var d=0;d<g.length&&!f.requestAnimationFrame;++d){f.requestAnimationFrame=window[g[d]+"RequestAnimationFrame"]}if(!f.requestAnimationFrame){f.requestAnimationFrame=function(h){var i=window.setTimeout(function(){h()},16);return i}}return function(h){f.requestAnimationFrame.apply(b,arguments)}})();a.sticky=function(){this.setting.runInScrollFn&&this.setting.runInScrollFn();var d=this.stickyNode.getBoundingClientRect();if(d.top<=this.top&&!this.isfixed){this.setFixedCss(this.fixedCss);this.fixedClazz&&$(this.fixedNode).addClass(this.fixedClazz);this.isfixed=true;$(this).trigger("onsticky",true)}else{if(d.top>this.top&&this.isfixed){this.setFixedCss(this.initCss.replace(/position:[^;]*/,"position:static"));b.setTimeout(function(){this.setFixedCss(this.initCss)}.bind(this),30);this.fixedClazz&&$(this.fixedNode).removeClass(this.fixedClazz);this.isfixed=false;$(this).trigger("onsticky",true)}}};$.initSticky=function(d){return new c(d)}})();