define(["https://h5.m.jd.com/dev/AoY8oPJews28R9bXaCcu41LJPm1/pages/180429/js/jquery.min.js","https://h5.m.jd.com/dev/AoY8oPJews28R9bXaCcu41LJPm1/pages/180429/js/trimPath.js","https://h5.m.jd.com/dev/AoY8oPJews28R9bXaCcu41LJPm1/pages/180429/js/touch.min.js"],function(){var f={"api":"https://api.m.jd.com/client.action?functionId=","productUrl":"queryMatProdsForGrps","goodsAppAddress":"https://item.m.jd.com/ware/view.action?wareId=","goodsWqAddress":"https://wqitem.jd.com/item/view?sku=","srcInitPic":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABAQMAAAAl21bKAAAAA1BMVEUAAACnej3aAAAAAXRSTlMAQObYZgAAAApJREFUCNdjYAAAAAIAAeIhvDMAAAAASUVORK5CYII=","uuid":(new Date).getTime()+97531};function a(j){var i=$(window).height(),h=j.height(),g=f.srcInitPic,k=j.offset().top-(document.documentElement.scrollTop+document.body.scrollTop);if(j.attr("src")==g&&k<=i&&k>-h){j.attr({"src":j.attr("data-src"),"data-src":""});j.css("opacity",1)}}function b(h,g){$.ajax({url:h,dataType:"jsonp",timeout:5000,jsonp:"callback",jsonpCallback:"jsonpCallback"+new Date().getTime(),success:function(i){g(i)},error:function(i){console.log(i)}}).then(function(){try{MPing.inputs.Click.attachEvent()}catch(i){}})}function e(){try{return(document.createElement("canvas").toDataURL("image/webp").indexOf("data:image/webp")==0)}catch(g){return false}}var c={isAppAddress:function(){return !!location.pathname.match(/^\/mall\//)},isWQAddress:function(){return !!location.pathname.match(/^\/wq\//)}};var d=(c.isWQAddress()?f.goodsWqAddress:f.goodsAppAddress);webpType=(e()?".webp":"");return{slideStyle:function(i){var g=$("#"+i.ele);var h='{for item in productList}<li><div class="goodsPic"><a class="J_ping" href="'+d+'${item.skuId}&clickUrl=" target="_self" report-eventid="Babel_dev_sku" report-eventparam="'+window.pageConfig.activityId+'_${item.skuId}_${groupId}_null_${item_index}" report-pagename="http:'+window.pageConfig.pageUrl+'" report-eventlevel="3"><img {if (item_index<4)} src="${item.image}" data-src="" style="opacity:1;"{else} src="'+f.srcInitPic+'" data-src="${item.image}'+webpType+'" {/if}></a></div><div class="goodsName"><a class="J_ping" href="'+d+'${item.skuId}&clickUrl=" target="_self" report-eventid="Babel_dev_sku" report-eventparam="'+window.pageConfig.activityId+'_${item.skuId}_${groupId}_null_${item_index}" report-pagename="http:'+window.pageConfig.pageUrl+'" report-eventlevel="3">${item.name}</a></div><div class="goodsYsPrice"><a class="J_ping" href="'+d+'${item.skuId}&clickUrl=" target="_self" report-eventid="Babel_dev_sku" report-eventparam="'+window.pageConfig.activityId+'_${item.skuId}_${groupId}_null_${item_index}" report-pagename="http:'+window.pageConfig.pageUrl+'" report-eventlevel="3"><span class="ys-price">{if (item.prePrice=="")}京东价:￥${item.pPrice}{else}京东价:￥${item.prePrice}{/if}</span></a></div><div class="goodsPrice"><a class="J_ping" href="'+d+'${item.skuId}&clickUrl=" target="_self" report-eventid="Babel_dev_sku" report-eventparam="'+window.pageConfig.activityId+'_${item.skuId}_${groupId}_null_${item_index}" report-pagename="http:'+window.pageConfig.pageUrl+'" report-eventlevel="3"><span class="p-price hide{if (item.prePrice=="")}{/if}">${item.appoints}件已预订</span></a></div><div class="dingjin"><a class="J_ping" href="'+d+'${item.skuId}&clickUrl=" target="_self" report-eventid="Babel_dev_sku" report-eventparam="'+window.pageConfig.activityId+'_${item.skuId}_${groupId}_null_${item_index}" report-pagename="http:'+window.pageConfig.pageUrl+'" report-eventlevel="3">立即购买</a></div></li>{/for}';var j=f.api+f.productUrl+'&body={"ids":"'+i.id+'","currentStageFlag":"Y","sourceCode":"jshop"}&client=wh5&clientVersion=1.0.0&sid=&uuid='+f.uuid;b(j,function(k){var l=k.groupList[0].stageList[0];if("success"==k.returnMsg&&l.productList&&l.productList.length>0){g.html(h.process(l))}})},tabStyle:function(i){var n=[],k="",m=i.data,h=$("#"+i.ele);var g='<div class="tab-wraper"><div class="tab-nav"><div class="tab-nav-left"><div class="tab-nav-list"><ul></ul></div></div></div></div><div class="presale-content"></div>';h.html(g);var j="",p=(h.width()-160)/4;m.map(function(r,l){k+='<li style="min-width:'+p+'px;" data-id="'+r.id+'">'+r.name+"</li>";n.push(r.id)});k=k+'<li class="sideline"></li>';h.find("ul").append(k);h.find("ul li").eq(0).addClass("ysTabsCur");var q='{for list in groupList}<ul class="presale-item" data-flTabs="${list.groupId}">{for item in list.stageList[0].productList}<li class="goods-item"><div class="goodsPic"><a class="J_ping" href="'+d+'${item.skuId}&clickUrl=" target="_self" report-eventid="Babel_dev_sku" report-eventparam="'+window.pageConfig.activityId+'_${item.skuId}_${list.groupId}_null_${item_index}" report-pagename="http:'+window.pageConfig.pageUrl+'" report-eventlevel="3"><img src="'+f.srcInitPic+'" data-src="${item.image}'+webpType+'"></a></div><div class="goodsName"><a class="J_ping" href="'+d+'${item.skuId}&clickUrl=" target="_self" report-eventid="Babel_dev_sku" report-eventparam="'+window.pageConfig.activityId+'_${item.skuId}_${list.groupId}_null_${item_index}" report-pagename="http:'+window.pageConfig.pageUrl+'" report-eventlevel="3">${item.name}</a></div><div class="goodsYsPrice"><a class="J_ping" href="'+d+'${item.skuId}&clickUrl=" target="_self" report-eventid="Babel_dev_sku" report-eventparam="'+window.pageConfig.activityId+'_${item.skuId}_${list.groupId}_null_${item_index}" report-pagename="http:'+window.pageConfig.pageUrl+'" report-eventlevel="3"> <span class="ys-price">{if (item.prePrice=="")}京东价:￥${item.pPrice}{else}京东价:￥${item.prePrice}{/if}</span></a></div><div class="goodsPrice"><a class="J_ping" href="'+d+'${item.skuId}&clickUrl=" target="_self" report-eventid="Babel_dev_sku" report-eventparam="'+window.pageConfig.activityId+'_${item.skuId}_${list.groupId}_null_${item_index}" report-pagename="http:'+window.pageConfig.pageUrl+'" report-eventlevel="3"><span class="yuding-num hide{if (item.prePrice=="")}{/if}">${item.appoints}件已预订</span><span class="p-price">上市价:￥${item.pcpPrice}</span></a></div><div class="dingjin"><a class="J_ping" href="'+d+'${item.skuId}&clickUrl=" target="_self" report-eventid="Babel_dev_sku" report-eventparam="'+window.pageConfig.activityId+'_${item.skuId}_${list.groupId}_null_${item_index}" report-pagename="http:'+window.pageConfig.pageUrl+'" report-eventlevel="3">立即购买</a></div></li>{/for}</ul>{/for}';
var o=f.api+f.productUrl+'&body={"ids":"'+n.join(",")+'","currentStageFlag":"Y","sourceCode":"jshop"}&client=wh5&clientVersion=1.0.0&sid=&uuid='+f.uuid;b(o,function(s){if("success"==s.returnMsg&&s.groupList&&s.groupList.length>0){var u=s;h.find(".presale-content").html(q.process(u));h.find('.presale-content ul[data-flTabs="'+n[0]+'"]').show().find("img").each(function(){a($(this))});var l=h.find(".tab-nav-list li").first().width();var r=h.find(".tab-nav-list").width();var v=h.find(".tab-nav-left").width();var t=h.find(".tab-nav-list .sideline");h.find(".sideline").width(l);h.find(".tab-nav-list li").on("tap",function(){var E=$(this),A=E.index(),z=E.width();var y=h.find('.presale-content ul[data-flTabs="'+n[A]+'"]');var x=0.1;l=$(this).width();t.stop(true);t.animate({width:l*x,left:$(this).position().left+(l/2-l*x/2)},300,function(){$(this).animate({left:$(this).position().left-(l/2-l*x/2),width:l},300)});$(this).addClass("tabsCur").siblings().removeClass("tabsCur");var B=(h.find(".tab-nav").width()-l)/2;var D;var C=parseInt($(this).position().left);if(C<=B){D=0}else{if(B-C<=v-r){D=v-r}else{D=B-C}}h.find(".tab-nav-list").animate({"left":D},300);y.show().siblings().hide();$("html,body").animate({scrollTop:h.offset().top},300);y.find("img").each(function(){a($(this))})});h.find(".tab-nav-list").on("touchstart",function(x){var w=x.originalEvent.targetTouches[0];x1=w.pageX;y1=w.pageY;ty_left=parseInt($(this).css("left"))});h.find(".tab-nav-list").on("touchmove",function(z){var y=z.originalEvent.targetTouches[0];var w=y.pageX;var x=y.pageY;if(ty_left+w-x1>=0){$(this).css("left",0)}else{if(ty_left+w-x1<=v-r){$(this).css("left",v-r)}else{$(this).css("left",ty_left+w-x1)}}if(Math.abs(x-y1)>0){z.preventDefault()}});require(["https://storage.360buyimg.com/babel/00067765/175382/active/scrollSticky.min.js"],function(y){var z=h.find(".tab-wraper");var w=h.find(".tab-nav");$.initSticky({stickyNode:z,fixedNode:w,top:0,zIndex:9,fixedClazz:"fixed",runInScrollFn:x});function x(){var A=$(window).scrollTop();var D=h.height();var B=h.offset().top;var C=h.offset().top+D;if(Math.floor(B)<=A&&Math.floor(C)>A){w.addClass("fixed")}else{w.removeClass("fixed");w.css({"position":"","top":"","z-index":""})}}})}})},listStyle:function(j){var g=$("#"+j.ele);var i='<div class="presale-content"><ul class="presale-item" style="display:block;"></ul></div>';g.html(i);var h='{for item in productList}<li class="goods-item"><div class="goodsPic"><a class="J_ping" href="'+d+'${item.skuId}&clickUrl=" target="_self" report-eventid="Babel_dev_sku" report-eventparam="'+window.pageConfig.activityId+'_${item.skuId}_${groupId}_null_${item_index}" report-pagename="http:'+window.pageConfig.pageUrl+'" report-eventlevel="3"><img src="'+f.srcInitPic+'" data-src="${item.image}'+webpType+'"></a></div><div class="goodsName"><a class="J_ping" href="'+d+'${item.skuId}&clickUrl=" target="_self" report-eventid="Babel_dev_sku" report-eventparam="'+window.pageConfig.activityId+'_${item.skuId}_${groupId}_null_${item_index}" report-pagename="http:'+window.pageConfig.pageUrl+'" report-eventlevel="3">${item.name}</a></div><div class="goodsYsPrice"><a class="J_ping" href="'+d+'${item.skuId}&clickUrl=" target="_self" report-eventid="Babel_dev_sku" report-eventparam="'+window.pageConfig.activityId+'_${item.skuId}_${groupId}_null_${item_index}" report-pagename="http:'+window.pageConfig.pageUrl+'" report-eventlevel="3"> <span class="ys-price">{if (item.prePrice=="")}京东价:￥${item.pPrice}{else}京东价:￥${item.prePrice}{/if}</span></a></div><div class="goodsPrice"><a class="J_ping" href="'+d+'${item.skuId}&clickUrl=" target="_self" report-eventid="Babel_dev_sku" report-eventparam="'+window.pageConfig.activityId+'_${item.skuId}_${groupId}_null_${item_index}" report-pagename="http:'+window.pageConfig.pageUrl+'" report-eventlevel="3"><span class="yuding-num hide{if (item.prePrice=="")}{/if}">${item.appoints}件已预订</span><span class="p-price">上市价:￥${item.pcpPrice}</span></a></div><div class="dingjin"><a class="J_ping" href="'+d+'${item.skuId}&clickUrl=" target="_self" report-eventid="Babel_dev_sku" report-eventparam="'+window.pageConfig.activityId+'_${item.skuId}_${groupId}_null_${item_index}" report-pagename="http:'+window.pageConfig.pageUrl+'" report-eventlevel="3">立即购买</a></div></li>{/for}';var k=f.api+f.productUrl+'&body={"ids":"'+j.id+'","currentStageFlag":"Y","sourceCode":"jshop"}&client=wh5&clientVersion=1.0.0&sid=&uuid='+f.uuid;b(k,function(l){var m=l.groupList[0].stageList[0];if("success"==l.returnMsg&&m.productList&&m.productList.length>0){g.find(".presale-item").html(h.process(m)).find("img").each(function(){a($(this))})}})}}});